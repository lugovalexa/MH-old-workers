did_social_high = lm(full_formula, data = subset(data, jqi_social_environment >= median(jqi_social_environment)), weights = my_wgt)
did_social_low= lm(full_formula, data = subset(data, jqi_social_environment < median(jqi_social_environment)), weights = my_wgt)
did_time_high = lm(full_formula, data = subset(data, jqi_working_time_quality >= median(jqi_working_time_quality)), weights = my_wgt)
did_time_low= lm(full_formula, data = subset(data, jqi_working_time_quality < median(jqi_working_time_quality)), weights = my_wgt)
did_intensity_high = lm(full_formula, data = subset(data, jqi_intensity >= median(jqi_intensity)), weights = my_wgt)
did_intensity_low= lm(full_formula, data = subset(data, jqi_intensity < median(jqi_intensity)), weights = my_wgt)
did_prospects_high = lm(full_formula, data = subset(data, jqi_prospects >= median(jqi_prospects)), weights = my_wgt)
did_prospects_low= lm(full_formula, data = subset(data, jqi_prospects < median(jqi_prospects)), weights = my_wgt)
summary(did_skills_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_skills_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_skills_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_skills_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_skills_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_skills_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_physical_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_physical_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_physical_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_physical_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_physical_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_physical_low, robust = "vcovHC")
table(subset(data, gender == 1 & jqi_physical_environment < median(jqi_physical_environment))$treated)
subset(data, gender == 1 & jqi_physical_environment < median(jqi_physical_environment))
table(subset(data, gender == 1 & jqi_physical_environment < median(jqi_physical_environment))$work_horizon_change)
summary(did_male_physical_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_social_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_social_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
did_social_high = lm(full_formula, data = subset(data, jqi_social_environment > median(jqi_social_environment)), weights = my_wgt)
did_social_low= lm(full_formula, data = subset(data, jqi_social_environment <= median(jqi_social_environment)), weights = my_wgt)
summary(did_social_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_social_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_social_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_social_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
table( subset(data, gender == 0 & jqi_social_environment < median(jqi_social_environment))$work_horizon_change)
table( subset(data, gender == 0 & jqi_social_environment >= median(jqi_social_environment))$work_horizon_change)
summary(did_female_social_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_social_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_time_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_time_high, robust = "vcovHC")
summary(did_time_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_time_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_time_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_time_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_time_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_intensity_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
cor(data$jqi_intensity,data$work_horizon_change)
cor(data$jqi_intensity,data$eurod)
summary(did_intensity_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_prospects_hig, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_prospects_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_prospects_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_prospects_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_prospects_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_prospects_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_prospects_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_intensity_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_intensity_high, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_female_intensity_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
summary(did_male_intensity_low, robust = "vcovHC")$coefficients['post:work_horizon_change',]
interaction_formula <- paste(interaction_terms_colnames, collapse = " + ")
full_formula <- reformulate(c("post*treated1", "gender","partnerinhh", "nb_children", "nb_grandchildren", "yrseducation", "sphus", "chronic",
"life_insurance", "investment", "thinc_log", "work_horizon", "jqi_physical_environment", "jqi_social_environment",
"jqi_intensity", "jqi_prospects", "jqi_working_time_quality", "jqi_skills_discretion", "as.factor(cell2)", "as.factor(industry)"),response="eurodcat")
noind_formula <- reformulate(c("post*treated1", "partnerinhh", "nb_children", "nb_grandchildren", "yrseducation", "sphus", "chronic",
"life_insurance", "investment", "thinc_log", "work_horizon", "jqi_physical_environment", "jqi_social_environment",
"jqi_intensity", "jqi_prospects", "jqi_working_time_quality",  "jqi_skills_discretion", "as.factor(cell2)", "as.factor(industry)"),response="eurodcat")
did_skills_high = lm(full_formula, data = subset(data, jqi_skills_discretion >= median(jqi_skills_discretion)), weights = my_wgt)
did_skills_low= lm(full_formula, data = subset(data, jqi_skills_discretion < median(jqi_skills_discretion)), weights = my_wgt)
did_physical_high = lm(full_formula, data = subset(data, jqi_physical_environment >= median(jqi_physical_environment)), weights = my_wgt)
did_physical_low= lm(full_formula, data = subset(data, jqi_physical_environment < median(jqi_physical_environment)), weights = my_wgt)
did_social_high = lm(full_formula, data = subset(data, jqi_social_environment >= median(jqi_social_environment)), weights = my_wgt)
did_social_low= lm(full_formula, data = subset(data, jqi_social_environment < median(jqi_social_environment)), weights = my_wgt)
did_time_high = lm(full_formula, data = subset(data, jqi_working_time_quality >= median(jqi_working_time_quality)), weights = my_wgt)
did_time_low= lm(full_formula, data = subset(data, jqi_working_time_quality < median(jqi_working_time_quality)), weights = my_wgt)
did_intensity_high = lm(full_formula, data = subset(data, jqi_intensity >= median(jqi_intensity)), weights = my_wgt)
did_intensity_low= lm(full_formula, data = subset(data, jqi_intensity < median(jqi_intensity)), weights = my_wgt)
did_prospects_high = lm(full_formula, data = subset(data, jqi_prospects >= median(jqi_prospects)), weights = my_wgt)
did_prospects_low= lm(full_formula, data = subset(data, jqi_prospects < median(jqi_prospects)), weights = my_wgt)
# DID female/male
did_female = lm(noind_formula, data = subset(data, gender == 1), weights = my_wgt)
did_male = lm(noind_formula, data = subset(data, gender == 0), weights = my_wgt)
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= median(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low= lm(noind_formula, data = subset(data, gender == 1 & jqi_skills_discretion < median(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_skills_discretion >= median(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_skills_discretion < median(jqi_skills_discretion)), weights = my_wgt)
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_physical_environment >= median(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_physical_environment < median(jqi_physical_environment)), weights = my_wgt)
did_male_physical_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_physical_environment >= median(jqi_physical_environment)), weights = my_wgt)
did_male_physical_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_physical_environment < median(jqi_physical_environment)), weights = my_wgt)
# DID female/male jqi_social_environment above/below mean
did_female_social_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_social_environment >= median(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_social_environment < median(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_social_environment >= median(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_social_environment < median(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= median(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_working_time_quality < median(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= median(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_working_time_quality < median(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_prospects >= median(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_prospects < median(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_prospects >= median(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_prospects < median(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_intensity >= median(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_intensity < median(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_intensity >= median(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_intensity < median(jqi_intensity)), weights = my_wgt)
summary(did_male, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_female, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_female_skills_high, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_male_skills_high, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_skills_high, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_skills_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_males_skills_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_male_skills_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_female_skills_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_physical_high, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_physical_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_male_physical_high, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_female_physical_high, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_female_physical_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_male_physical_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_social_high, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_male_social_high, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_female_social_high, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_female_social_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_male_social_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_social_low, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_male, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_male, robust = "vcovHC")
summary(did_male, robust = "vcovHC")
did_sum_male_h = lm(noind_formula, data = subset(data, gender == 0 & jqi_sum >= median(jqi_sum)), weights = my_wgt)
did_sum_male_l = lm(noind_formula, data = subset(data, gender == 0 & jqi_sum < median(jqi_sum)), weights = my_wgt)
summary(did_sum_male_h, robust = "vcovHC")$coefficients['post:treated1',]
summary(did_sum_male_l, robust = "vcovHC")$coefficients['post:treated1',]
fit4 <- lm(eurodcat ~ post*treated1 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell2) + as.factor(industry),
data=data, weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated1',]
# Models - LM
# Libraries
library(plm)
library(lmtest)
library(dplyr)
library(crosstable)
library(did)
library(car)
library(corrplot)
library(ggplot2)
library(glmnet)
library(MASS)
library(texreg)
library(sandwich)
library(fixest)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_year.csv")
# Additional variables
data$age_squared <- data$age^2
data$thinc_log <- log(data$thinc + 1e-8)
data$eurod_log <- log(data$eurod + 1e-8)
data$post = ifelse(data$year >= 2015, 1, 0)
data$treated0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$treated1 <- ifelse(data$work_horizon_change > 1, 1, 0)
data$treated2 <- ifelse(data$work_horizon_change >= 2, 1, 0)
# Cell
data$cell1 <- paste(data$country, data$gender, sep = "_")
data$cell2 <- paste(data$country, data$work_horizon_change, sep = "_")
cells_to_remove <- data %>% group_by(cell2) %>% summarise(count = n(), .groups = 'drop') %>% filter(count < 4) %>% pull(cell2)
data <- data %>% filter(!(cell2 %in% cells_to_remove))
# Subsets for genders
dataf <- subset(data,gender==1)
datam <- subset(data,gender==0)
# Basic model
fit1 <- lm(eurod ~ post*treated0, data=data, weights=my_wgt)
summary(fit1, robust = "vcovHC")
# Model with cell fixed effects
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=data, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit3 <- lm(eurodcat ~ post*treated2 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=data)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurod ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=data)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurodcat ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=data)
summary(fit3, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=dataf, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=datam, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell1), data=datam, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=datam, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(data, jqi_skills_discretion < median(jqi_skills_discretion)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(data, jqi_skills_discretion >= median(jqi_skills_discretion)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_skills_discretion >= median(jqi_skills_discretion)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_skills_discretion < median(jqi_skills_discretion)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurodcat ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_skills_discretion < median(jqi_skills_discretion)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit3 <- lm(eurod ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=subset(dataf, jqi_skills_discretion < median(jqi_skills_discretion)))
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurod ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=subset(dataf, jqi_skills_discretion <= median(jqi_skills_discretion)))
summary(fit3, robust = "vcovHC")
fit4 <- lm(eurodcat ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell2) + as.factor(industry),
data=subset(dataf, jqi_skills_discretion < median(jqi_skills_discretion)), weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
fit4 <- lm(eurodcat ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell2) + as.factor(industry),
data=subset(dataf, jqi_skills_discretion >= median(jqi_skills_discretion)), weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell2) + as.factor(industry),
data=subset(dataf, jqi_skills_discretion >= median(jqi_skills_discretion)), weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_working_time_quality < median(jqi_working_time_quality)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_working_time_quality > median(jqi_working_time_quality)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_physical_environment > median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
# Model with cell fixed effects
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(datam, jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(datam, jqi_physical_environment > median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated1 + as.factor(cell2), data=subset(datam, jqi_physical_environment > median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated1 + as.factor(cell2), data=subset(datam, jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated1 + as.factor(cell2), data=subset(dataf, jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_physical_environment < mean(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=subset(dataf, jqi_physical_environment < median(jqi_physical_environment)))
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=data, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*work_horizon_change + as.factor(cell2), data=data, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurodcat ~ post*work_horizon_change + as.factor(cell2), data=data, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*work_horizon_change + as.factor(cell2), data=data, weights=my_wgt)
summary(fit2, robust = "vcovHC")
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_year_country.csv")
# Additional variables
data$age_squared <- data$age^2
data$thinc_log <- log(data$thinc + 1e-8)
data$eurod_log <- log(data$eurod + 1e-8)
data$post = ifelse(data$year >= 2015, 1, 0)
data$treated0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$treated1 <- ifelse(data$work_horizon_change > 1, 1, 0)
data$treated2 <- ifelse(data$work_horizon_change >= 2, 1, 0)
# Cell
data$cell1 <- paste(data$country, data$gender, sep = "_")
data$cell2 <- paste(data$country, data$work_horizon_change, sep = "_")
cells_to_remove <- data %>% group_by(cell2) %>% summarise(count = n(), .groups = 'drop') %>% filter(count < 4) %>% pull(cell2)
data <- data %>% filter(!(cell2 %in% cells_to_remove))
# Subsets for genders
dataf <- subset(data,gender==1)
datam <- subset(data,gender==0)
fit1 <- lm(eurod ~ post*treated0, data=data, weights=my_wgt)
summary(fit1, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=data, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=dataf, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell2), data=datam, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit3 <- lm(eurod ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=data, weights=my_wgt)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurod ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=dataf, weights=my_wgt)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurod ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=datam, weights=my_wgt)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurodcat ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=datam, weights=my_wgt)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurodcat ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=dataf, weights=my_wgt)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurodcat ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=data, weights=my_wgt)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurodcat ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=subset(dataf, jqi_skills_discretion >= median(jqi_skills_discretion)), weights=my_wgt)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurodcat ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=subset(dataf, jqi_skills_discretion < median(jqi_skills_discretion)), weights=my_wgt)
summary(fit3, robust = "vcovHC")
fit3 <- lm(eurod ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=subset(dataf, jqi_skills_discretion < median(jqi_skills_discretion)), weights=my_wgt)
summary(fit3, robust = "vcovHC")
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_year.csv")
# Data
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_year.csv")
# Additional variables
data$age_squared <- data$age^2
data$thinc_log <- log(data$thinc + 1e-8)
data$eurod_log <- log(data$eurod + 1e-8)
data$post = ifelse(data$year >= 2015, 1, 0)
data$treated0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$treated1 <- ifelse(data$work_horizon_change > 1, 1, 0)
data$treated2 <- ifelse(data$work_horizon_change >= 2, 1, 0)
# Cell
data$cell1 <- paste(data$country, data$gender, sep = "_")
dataf <- subset(data,gender==1)
datam <- subset(data,gender==0)
# Basic model
fit1 <- lm(eurod ~ post*treated0, data=data, weights=my_wgt)
summary(fit1, robust = "vcovHC")
# Model with cell fixed effects
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell1), data=data, weights=my_wgt)
summary(fit2, robust = "vcovHC")
# Model with cell fixed effects
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell1), data=dataf, weights=my_wgt)
summary(fit2, robust = "vcovHC")
# Model with cell fixed effects
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell1), data=datam, weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit3 <- lm(eurod ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell2) + as.factor(industry),
data=data, weights=my_wgt)
fit3 <- lm(eurod ~ post*treated0 + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=data, weights=my_wgt)
summary(fit3, robust = "vcovHC")
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell2) + as.factor(industry),
data=data), weights=my_wgt)
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell2) + as.factor(industry),
data=data, weights=my_wgt)
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell1) + as.factor(industry),
data=data, weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
# Full model
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
# Full model
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell1) + as.factor(industry),
data=datam, weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
# Full model
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell1) + as.factor(industry),
data=subset(data,jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell1) + as.factor(industry),
data=subset(data,jqi_physical_environment >= median(jqi_physical_environment)), weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell1) + as.factor(industry),
data=subset(datam,jqi_physical_environment >= median(jqi_physical_environment)), weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
# Full model
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell1) + as.factor(industry),
data=subset(datam,jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell1) + as.factor(industry),
data=subset(dataf,jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
# Full model
fit4 <- lm(eurod ~ post*treated0 + gender + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc_log + work_horizon + jqi_physical_environment + jqi_social_environment
+ jqi_intensity + jqi_prospects + jqi_working_time_quality + jqi_skills_discretion + as.factor(cell1) + as.factor(industry),
data=subset(dataf,jqi_physical_environment > median(jqi_physical_environment)), weights=my_wgt)
summary(fit4, robust = "vcovHC")$coefficients['post:treated0',]
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell1), data=subset(dataf,jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell1), data=subset(datam,jqi_physical_environment < median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
fit2 <- lm(eurod ~ post*treated0 + as.factor(cell1), data=subset(datam,jqi_physical_environment > median(jqi_physical_environment)), weights=my_wgt)
summary(fit2, robust = "vcovHC")
full_formula <- reformulate(c("post*treated0", "as.factor(cell1)"),response="eurod")
noind_formula <- reformulate(c("post*treated0", "as.factor(cell1)"),response="eurod")
did_skills_high = lm(full_formula, data = subset(data, jqi_skills_discretion > median(jqi_skills_discretion)), weights = my_wgt)
did_skills_low= lm(full_formula, data = subset(data, jqi_skills_discretion < median(jqi_skills_discretion)), weights = my_wgt)
did_physical_high = lm(full_formula, data = subset(data, jqi_physical_environment > median(jqi_physical_environment)), weights = my_wgt)
did_physical_low= lm(full_formula, data = subset(data, jqi_physical_environment < median(jqi_physical_environment)), weights = my_wgt)
did_social_high = lm(full_formula, data = subset(data, jqi_social_environment > median(jqi_social_environment)), weights = my_wgt)
did_social_low= lm(full_formula, data = subset(data, jqi_social_environment < median(jqi_social_environment)), weights = my_wgt)
did_time_high = lm(full_formula, data = subset(data, jqi_working_time_quality > median(jqi_working_time_quality)), weights = my_wgt)
did_time_low= lm(full_formula, data = subset(data, jqi_working_time_quality < median(jqi_working_time_quality)), weights = my_wgt)
did_intensity_high = lm(full_formula, data = subset(data, jqi_intensity > median(jqi_intensity)), weights = my_wgt)
did_intensity_low= lm(full_formula, data = subset(data, jqi_intensity < median(jqi_intensity)), weights = my_wgt)
did_prospects_high = lm(full_formula, data = subset(data, jqi_prospects > median(jqi_prospects)), weights = my_wgt)
did_prospects_low= lm(full_formula, data = subset(data, jqi_prospects < median(jqi_prospects)), weights = my_wgt)
did_female = lm(noind_formula, data = subset(data, gender == 1), weights = my_wgt)
did_male = lm(noind_formula, data = subset(data, gender == 0), weights = my_wgt)
did_female_skills_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_skills_discretion > median(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low= lm(noind_formula, data = subset(data, gender == 1 & jqi_skills_discretion < median(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_skills_discretion > median(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_skills_discretion < median(jqi_skills_discretion)), weights = my_wgt)
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_physical_environment > median(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_physical_environment < median(jqi_physical_environment)), weights = my_wgt)
did_male_physical_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_physical_environment > median(jqi_physical_environment)), weights = my_wgt)
did_male_physical_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_physical_environment < median(jqi_physical_environment)), weights = my_wgt)
did_female_social_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_social_environment > median(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_social_environment < median(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_social_environment > median(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_social_environment < median(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_working_time_quality > median(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_working_time_quality < median(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_working_time_quality > median(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_working_time_quality < median(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_prospects > median(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_prospects < median(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_prospects > median(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_prospects < median(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(noind_formula, data = subset(data, gender == 1 & jqi_intensity > median(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(noind_formula, data = subset(data, gender == 1 & jqi_intensity < median(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(noind_formula, data = subset(data, gender == 0 & jqi_intensity > median(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(noind_formula, data = subset(data, gender == 0 & jqi_intensity < median(jqi_intensity)), weights = my_wgt)
did_full <- lm(full_formula, data=data, weights=my_wgt)
summary(did_full, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_skills_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_skills_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_physical_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_physical_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_social_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_social_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_time_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_time_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_intensity_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_intensity_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_prospects_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_prospects_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_skills_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_skills_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_physical_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_physical_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_physical_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_social_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_social_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_time_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_time_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_intensity_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_intensity_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_prospects_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_male_prospects_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_skills_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_skills_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_physical_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_physical_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_social_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_social_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_time_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_time_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_intensity_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_intensity_low, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_prospects_high, robust = "vcovHC")$coefficients['post:treated0',]
summary(did_female_prospects_low, robust = "vcovHC")$coefficients['post:treated0',]
