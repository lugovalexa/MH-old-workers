+ life_insurance + investment + thinc2 + work_horizon + jqi_sum + as.factor(country) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="country")
fe_mod4 <- glm(eurod ~ treated + time + did + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(country) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="country")
fe_mod4 <- glm(eurod ~ did + as.factor(year) + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(country) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="country")
# Multicollinearity VIF TEST
vif(fe_mod4)
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(country) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="country")
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(mergeid) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="country")
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# children and grandchildren together
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change_total > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change_total > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change_total, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change_total > 0) %>%
distinct(mergeid)
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# Determine cell fol fixed effects/ cluster standard errors
data$cell <- paste(data$country, data$gender, sep = "_")
# Interactions of indexes
interaction_terms <- model.matrix(~ (jqi_skills_discretion + jqi_physical_environment +
jqi_social_environment + jqi_working_time_quality +
jqi_prospects + jqi_intensity)^2, data = data)
interaction_terms <- interaction_terms[, -c(1, 2, 3, 4, 5, 6, 7)]
interaction_terms_colnames <- colnames(interaction_terms)
data <- cbind(data, interaction_terms)
# For YTR between 0 and 1 only
#sum_by_mergeid <- data %>% group_by(mergeid) %>% summarize(total_work_horizon_change = sum(work_horizon_change, na.rm = TRUE))
#mergeid_to_remove <- sum_by_mergeid %>% filter(total_work_horizon_change > 1) %>% pull(mergeid)
#data <- data %>% filter(!(mergeid %in% mergeid_to_remove))
# Remove 2 individuals with extreme eurod values
#rows_to_remove <- data %>%
#  filter(eurod == 12) %>%
#  distinct(mergeid)
#data <- data %>%
#  filter(!mergeid %in% rows_to_remove$mergeid)
dataf <- subset(data, gender == 1)
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(mergeid) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# children and grandchildren together
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change_total > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change_total > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change_total, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change_total > 0) %>%
distinct(mergeid)
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# Determine cell fol fixed effects/ cluster standard errors
data$cell <- paste(data$country, data$gender, sep = "_")
# Interactions of indexes
interaction_terms <- model.matrix(~ (jqi_skills_discretion + jqi_physical_environment +
jqi_social_environment + jqi_working_time_quality +
jqi_prospects + jqi_intensity)^2, data = data)
interaction_terms <- interaction_terms[, -c(1, 2, 3, 4, 5, 6, 7)]
interaction_terms_colnames <- colnames(interaction_terms)
data <- cbind(data, interaction_terms)
# For YTR between 0 and 1 only
#sum_by_mergeid <- data %>% group_by(mergeid) %>% summarize(total_work_horizon_change = sum(work_horizon_change, na.rm = TRUE))
#mergeid_to_remove <- sum_by_mergeid %>% filter(total_work_horizon_change > 1) %>% pull(mergeid)
#data <- data %>% filter(!(mergeid %in% mergeid_to_remove))
# Remove 2 individuals with extreme eurod values
rows_to_remove <- data %>%
filter(eurod == 12) %>%
distinct(mergeid)
data <- data %>%
filter(!mergeid %in% rows_to_remove$mergeid)
dataf <- subset(data, gender == 1)
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(mergeid) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="country")
dataf$cell1 <- paste(data$country, data$work_horizon_change_total, sep = "_")
dataf$cell1 <- paste(dataf$country, dataf$work_horizon_change_total, sep = "_")
table(dataf$cell)
table(dataf$cell1)
table(subset(dataf$time == 0)$cell1)
subset(dataf$time == 0)
table(subset(dataf,time == 0)$cell1)
subset(dataf,time == 1) %>% select(c(mergeid,country,work_horizon_change_total))
subset(dataf,time == 1) %>% select(mergeid,country,work_horizon_change_total)
dataf %>%
filter(time == 1) %>%
select(mergeid, country, work_horizon_change_total)
dataf %>%
filter(time == 1) %>%
select(c(mergeid, country, work_horizon_change_total))
dataf %>%
filter(time == 1) %>%
select(mergeid, country, work_horizon_change_total)
library(plm)
library(lmtest)
library(dplyr)
library(crosstable)
library(did)
library(car)
library(corrplot)
library(ggplot2)
library(glmnet)
library(MASS)
library(texreg)
dataf %>%
filter(time == 1) %>%
select(mergeid, country, work_horizon_change_total)
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015
dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf %>%
dplyr:filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
summary(dataf2015)
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015$cell1 <- paste(dataf2015$country, dataf2015$work_horizon_change_total, sep = "_")
merged_dataf <- dataf %>%
left_join(dataf2015 %>% dplyr::select(mergeid,cell1), by = "mergeid")
merged_dataf$cell1
merged_dataf
table(dataf$cell1.y)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# children and grandchildren together
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change_total > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change_total > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change_total, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change_total > 0) %>%
distinct(mergeid)
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# Determine cell fol fixed effects/ cluster standard errors
data$cell <- paste(data$country, data$gender, sep = "_")
# Interactions of indexes
interaction_terms <- model.matrix(~ (jqi_skills_discretion + jqi_physical_environment +
jqi_social_environment + jqi_working_time_quality +
jqi_prospects + jqi_intensity)^2, data = data)
interaction_terms <- interaction_terms[, -c(1, 2, 3, 4, 5, 6, 7)]
interaction_terms_colnames <- colnames(interaction_terms)
data <- cbind(data, interaction_terms)
# For YTR between 0 and 1 only
#sum_by_mergeid <- data %>% group_by(mergeid) %>% summarize(total_work_horizon_change = sum(work_horizon_change, na.rm = TRUE))
#mergeid_to_remove <- sum_by_mergeid %>% filter(total_work_horizon_change > 1) %>% pull(mergeid)
#data <- data %>% filter(!(mergeid %in% mergeid_to_remove))
# Remove 2 individuals with extreme eurod values
rows_to_remove <- data %>%
filter(eurod == 12) %>%
distinct(mergeid)
data <- data %>%
filter(!mergeid %in% rows_to_remove$mergeid)
dataf <- subset(data, gender == 1)
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015$cell1 <- paste(dataf2015$country, dataf2015$work_horizon_change_total, sep = "_")
dataf <- dataf %>%
left_join(dataf2015 %>% dplyr::select(mergeid,cell1), by = "mergeid")
table(subset(dataf,time == 0)$cell1)
table(subset(dataf,time == 0)$cell1)
dataf %>%
group_by(cell1) %>%
summarise(count = n(), .groups = 'drop') %>%
filter(count >= 3)
dataf %>%
group_by(cell1) %>%
summarise(count = n(), .groups = 'drop') %>%
filter(count >= 3) %>% pull(mergeid)
dataf %>%
group_by(cell1) %>%
summarise(count = n(), .groups = 'drop') %>%
filter(count >= 3) %>% pull(cell1)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# children and grandchildren together
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change_total > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change_total > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change_total, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change_total > 0) %>%
distinct(mergeid)
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# Determine cell fol fixed effects/ cluster standard errors
data$cell <- paste(data$country, data$gender, sep = "_")
# Interactions of indexes
interaction_terms <- model.matrix(~ (jqi_skills_discretion + jqi_physical_environment +
jqi_social_environment + jqi_working_time_quality +
jqi_prospects + jqi_intensity)^2, data = data)
interaction_terms <- interaction_terms[, -c(1, 2, 3, 4, 5, 6, 7)]
interaction_terms_colnames <- colnames(interaction_terms)
data <- cbind(data, interaction_terms)
# For YTR between 0 and 1 only
#sum_by_mergeid <- data %>% group_by(mergeid) %>% summarize(total_work_horizon_change = sum(work_horizon_change, na.rm = TRUE))
#mergeid_to_remove <- sum_by_mergeid %>% filter(total_work_horizon_change > 1) %>% pull(mergeid)
#data <- data %>% filter(!(mergeid %in% mergeid_to_remove))
# Remove 2 individuals with extreme eurod values
rows_to_remove <- data %>%
filter(eurod == 12) %>%
distinct(mergeid)
data <- data %>%
filter(!mergeid %in% rows_to_remove$mergeid)
dataf <- subset(data, gender == 1)
summary(dataf)
nrow(dataf)
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015$cell1 <- paste(dataf2015$country, dataf2015$work_horizon_change_total, sep = "_")
dataf <- dataf %>%
left_join(dataf2015 %>% dplyr::select(mergeid,cell1), by = "mergeid")
cells_to_remove <- dataf %>%
group_by(cell1) %>%
summarise(count = n(), .groups = 'drop') %>%
filter(count < 3) %>% pull(cell1)
dataf <- dataf %>% filter(!(mergeid %in% cells_to_remove))
nrow(dataf)
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015$cell1 <- paste(dataf2015$country, dataf2015$work_horizon_change_total, sep = "_")
dataf <- dataf %>%
left_join(dataf2015 %>% dplyr::select(mergeid,cell1), by = "mergeid")
cells_to_remove <- dataf %>%
group_by(cell1) %>%
summarise(count = n(), .groups = 'drop') %>%
filter(count < 3) %>% pull(cell1)
dataf$cell1
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# children and grandchildren together
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change_total > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change_total > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change_total, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change_total > 0) %>%
distinct(mergeid)
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# Determine cell fol fixed effects/ cluster standard errors
data$cell <- paste(data$country, data$gender, sep = "_")
# Interactions of indexes
interaction_terms <- model.matrix(~ (jqi_skills_discretion + jqi_physical_environment +
jqi_social_environment + jqi_working_time_quality +
jqi_prospects + jqi_intensity)^2, data = data)
interaction_terms <- interaction_terms[, -c(1, 2, 3, 4, 5, 6, 7)]
interaction_terms_colnames <- colnames(interaction_terms)
data <- cbind(data, interaction_terms)
# For YTR between 0 and 1 only
#sum_by_mergeid <- data %>% group_by(mergeid) %>% summarize(total_work_horizon_change = sum(work_horizon_change, na.rm = TRUE))
#mergeid_to_remove <- sum_by_mergeid %>% filter(total_work_horizon_change > 1) %>% pull(mergeid)
#data <- data %>% filter(!(mergeid %in% mergeid_to_remove))
# Remove 2 individuals with extreme eurod values
rows_to_remove <- data %>%
filter(eurod == 12) %>%
distinct(mergeid)
data <- data %>%
filter(!mergeid %in% rows_to_remove$mergeid)
dataf <- subset(data, gender == 1)
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015$cell1 <- paste(dataf2015$country, dataf2015$work_horizon_change_total, sep = "_")
dataf2015
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015$cell1 <- paste(dataf2015$country, dataf2015$work_horizon_change_total, sep = "_")
dataf %>%
left_join(dataf2015 %>% dplyr::select(mergeid,cell1), by = "mergeid")
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015$cell1 <- paste(dataf2015$country, dataf2015$work_horizon_change_total, sep = "_")
dataf <- dataf %>%
left_join(dataf2015 %>% dplyr::select(mergeid,cell1), by = "mergeid")
cells_to_remove <- dataf %>%
group_by(cell1) %>%
summarise(count = n(), .groups = 'drop') %>%
filter(count < 3) %>% pull(cell1)
dataf %>% filter(!(mergeid %in% cells_to_remove))
dataf <- subset(data, gender == 1)
nrow(dataf)
cells_to_remove
cells_to_remove <- dataf %>%
group_by(cell1) %>%
summarise(count = n(), .groups = 'drop') %>%
filter(count < 3) %>% pull(cell1)
dataf <- subset(data, gender == 1)
dataf2015 <- dataf %>%
filter(time == 1) %>%
dplyr::select(mergeid, country, work_horizon_change_total)
dataf2015$cell1 <- paste(dataf2015$country, dataf2015$work_horizon_change_total, sep = "_")
dataf <- dataf %>%
left_join(dataf2015 %>% dplyr::select(mergeid,cell1), by = "mergeid")
cells_to_remove <- dataf %>%
group_by(cell1) %>%
summarise(count = n(), .groups = 'drop') %>%
filter(count < 3) %>% pull(cell1)
dataf <- dataf %>% filter(!(cell1 %in% cells_to_remove))
nrow(dataf)
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
par(mfrow = c(2, 2))
plot(fe_mod4)
# Multicollinearity VIF TEST
vif(fe_mod4)
fe_mod4 <- glm(eurod ~ treated + did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
# Multicollinearity VIF TEST
vif(fe_mod4)
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
drop_in_dev <- anova(fe_mod2, fe_mod4, test = "F")
fe_mod2 <- glm(eurod ~  did,
data  = dataf, weights=my_wgt, family = "quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod2)
drop_in_dev <- anova(fe_mod2, fe_mod4, test = "F")
print(drop_in_dev)
anova(fe_mod2, fe_mod4, test = "Chisq")
AIC(fe_mod4)
optim_info <- fe_mod4$control$optimInfo
print(optim_info)
logLik(fe_mod4)
anova(fe_mod4, test = "F")
anova(fe_mod4, test = "F")
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt, family="poisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
mod.nb1 <- glm.nb(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt)
summary(mod.nb1)
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt, family="poisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
aic <- AIC(mod.nb1)
r_sq_nagelkerke <- 1 - (1 / exp(aic))
r_sq_nagelkerke
L0 <- logLik(fe_mod2)
L1 <- logLik(mod.nb1)
# Calculate Nagelkerke's R-squared
n <- nrow(dataf)
r_sq_nagelkerke <- (L1 - L0) / (2 / n)
r_sq_nagelkerke <- 1 - exp(-r_sq_nagelkerke)
L0 <- logLik(null_model)
r_sq_nagelkerke
L0 <- logLik(fe_mod2)
L1 <- logLik(mod.nb1)
# Calculate Nagelkerke's R-squared
n <- nrow(dataf)
r_sq_nagelkerke <- (L1 - L0) / (2 / n)
r_sq_nagelkerke <- 1 - exp(-r_sq_nagelkerke)
r_sq_nagelkerke
L0 <- logLik(glm.nb(eurod ~ did,
data=dataf, weights=my_wgt))
L1 <- logLik(mod.nb1)
# Calculate Nagelkerke's R-squared
n <- nrow(dataf)
r_sq_nagelkerke <- (L1 - L0) / (2 / n)
r_sq_nagelkerke <- 1 - exp(-r_sq_nagelkerke)
r_sq_nagelkerke
fe_mod4 <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry),
data=dataf, weights=my_wgt, family="quasipoisson")
#summary(fe_mod2)$coefficients['work_horizon_change_total',]
summary(fe_mod4, vcov = vcovHC, type = "HC1", clustered_se="cell1")
mylogit <- glm(aeurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry), data = dataf, weights=my_wgt, family = "binomial")
mylogit <- glm(eurod ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry), data = dataf, weights=my_wgt, family = "binomial")
mylogit <- glm(eurodcat ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + thinc2_log + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry), data = dataf, weights=my_wgt, family = "binomial")
summary(mylogit, vcov = vcovHC, type = "HC1", clustered_se="cell1")
mylogit <- glm(eurodcat ~ did + time + partnerinhh + nb_children + nb_grandchildren + yrseducation + sphus + chronic
+ life_insurance + investment + work_horizon + jqi_sum + as.factor(cell1) + as.factor(industry), data = dataf, weights=my_wgt, family = "binomial")
summary(mylogit, vcov = vcovHC, type = "HC1", clustered_se="cell1")
