# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change > 0) %>%
select(mergeid) %>%
distinct()
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
pdata <- pdata.frame(data, index = c("mergeid", "year"))
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = pdata, model = "within", effect = "individual")
# Display summary
summary(didreg)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change > 0) %>%
select(mergeid) %>%
distinct()
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# demographics
data_summary <- data %>% dplyr::select(gender, age, nb_children, nb_grandchildren, partnerinhh, yrseducation, thinc, investment, life_insurance)
knitr::kable(psych::describe(data_summary, skew = FALSE), digits = c(1,4,2,2,1,1,1,3))
pdata <- pdata.frame(data, index = c("mergeid", "year"))
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = pdata, model = "within", effect = "individual")
# Display summary
summary(didreg)
data_summary <- pdata %>% dplyr::select(gender, age, nb_children, nb_grandchildren, partnerinhh, yrseducation, thinc, investment, life_insurance)
knitr::kable(psych::describe(data_summary, skew = FALSE), digits = c(1,4,2,2,1,1,1,3))
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = pdata, model = "within", effect = "individual")
# Display summary
summary(didreg)
summary(plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = pdata, model = "within", effect = "individual"))
summary(plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = data, model = "within", effect = "individual"))
didreg = lm(eurod ~ treated + time + did, data = data)
summary(didreg)
didreg = lm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country), data = data)
summary(didreg)
colSums(is.na(pdata))
library(plm)
library(lmtest)
library(dplyr)
library(crosstable)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change > 0) %>%
select(mergeid) %>%
distinct()
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
didreg = lm(eurod ~ treated + time + did, data = data)
summary(didreg)
didreg = lm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country), data = data)
summary(didreg)
logit_reg <- glm(eurodcat ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country), data = data,
family = binomial(link = "logit"))
summary(logit_reg)
pdata <- pdata.frame(data, index = c("mergeid", "year"))
summary(plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = data, model = "within", effect = "individual"))
pdata <- pdata.frame(data, index = c("mergeid", "year"))
summary(plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = data, model = "within", effect = "individual"))
colSums(is.na(pdata))
table(data$mergeid, data$year)
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = pdata, model = "within", effect = "individual")
# Display summary
summary(didreg)
is.pbalanced(didreg)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change >= 1) %>%
select(mergeid) %>%
distinct()
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
didreg = lm(eurod ~ treated + time + did, data = data)
summary(didreg)
didreg = lm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country), data = data)
summary(didreg)
logit_reg <- glm(eurodcat ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country), data = data,
family = binomial(link = "logit"))
summary(logit_reg)
pdata <- pdata.frame(data, index = c("mergeid", "year"))
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = pdata, model = "within", effect = "individual")
# Display summary
summary(didreg)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change > 1) %>%
select(mergeid) %>%
distinct()
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# work
data_summary <- data %>% dplyr::select(yrscontribution, retirement_age, work_horizon, work_horizon_change, jqi_skills_discretion, jqi_physical_environment, jqi_social_environment, jqi_working_time_quality, jqi_prospects, jqi_intensity, jqi_sum)
knitr::kable(psych::describe(data_summary, skew = FALSE), digits = c(1,4,2,2,1,1,1,3))
pdata <- pdata.frame(data, index = c("mergeid", "year"))
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = pdata, model = "within", effect = "individual")
# Display summary
summary(didreg)
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "within")
coeftest(fe_mod, vcov. = vcovHC, type = "HC1")
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change_bin + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "within")
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change_bin0 + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "within")
coeftest(fe_mod, vcov. = vcovHC, type = "HC1")
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change_bin1 + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "within")
coeftest(fe_mod, vcov. = vcovHC, type = "HC1")
fe_mod <- plm(eurod ~ work_horizon + factor(work_horizon_change_cat) + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "within")
coeftest(fe_mod, vcov. = vcovHC, type = "HC1")
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change >= 2) %>%
select(mergeid) %>%
distinct()
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
didreg = lm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country), data = data)
summary(didreg)
logit_reg <- glm(eurodcat ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country), data = data,
family = binomial(link = "logit"))
summary(logit_reg)
pdata <- pdata.frame(data, index = c("mergeid", "year"))
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = pdata, model = "within", effect = "individual")
# Display summary
summary(didreg)
library(plm)
library(lmtest)
library(dplyr)
library(crosstable)
subset_data <- subset(pdata, gender == 1)
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = subset_data, model = "within", effect = "individual")
# Display summary
summary(didreg)
subset_data <- subset(pdata, gender == 0)
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = subset_data, model = "within", effect = "individual")
# Display summary
summary(didreg)
subset_data <- subset(pdata, gender == 1)
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = subset_data, model = "within", effect = "individual")
# Display summary
summary(didreg)
library(plm)
library(lmtest)
library(dplyr)
library(crosstable)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change > 0) %>%
select(mergeid) %>%
distinct()
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "within")
coeftest(fe_mod, vcov. = vcovHC, type = "HC1")
didreg = lm(eurod ~ treated + time + did, data = data)
summary(didreg)
didreg = lm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country), data = data)
summary(didreg)
logit_reg <- glm(eurodcat ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country), data = data,
family = binomial(link = "logit"))
summary(logit_reg)
pdata <- pdata.frame(data, index = c("mergeid", "year"))
didreg <- plm(eurod ~ treated + time + did + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity,
data = pdata, model = "within", effect = "individual")
# Display summary
summary(didreg)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year.csv")
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balances.csv")
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change > 0) %>%
select(mergeid) %>%
distinct()
library(plm)
library(lmtest)
library(dplyr)
library(crosstable)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change > 0) %>%
select(mergeid) %>%
distinct()
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "random")
coeftest(fe_mod, vcov. = vcovHC, type = "HC1")
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "random")
#coeftest(fe_mod, vcov. = vcovHC, type = "HC1")
summary(fe_mod)
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "within")
coeftest(fe_mod, vcov. = vcovHC, type = "HC1")
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "within")
summary(fe_mod)
re_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "random")
#coeftest(fe_mod, vcov. = vcovHC, type = "HC1")
summary(re_mod)
phtest(fe_mod,re_mod) #Hausman test
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "fd")
summary(fe_mod)
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "within")
summary(fe_mod)
l_mod <- lm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data)
summary(l_mod)
pFtest(fe_mod, l_mod) # pFtest ->
l_mod_d <- lm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country)  + factor(mergeid),
data = data)
summary(l_mod_d)
l_mod <- lm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity  + factor(country),
data = data)
summary(l_mod)
l_mod <- lm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data)
summary(l_mod)
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("isco", "year"),
model = "within")
summary(fe_mod)
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("isco", "country", "year"),
model = "within")
summary(fe_mod)
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid","year"),
model = "within")
summary(fe_mod)
fe_mod_time <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country) + factor(year),
data = data,
index = c("mergeid","year"),
model = "within")
summary(fe_mod_time)
fe_mod_time <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country) + factor(year),
data = data,
index = c("mergeid","year"),
model = "within")
pFtest(fe_mod_time, fe_mod)
fe_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid","year"),
model = "within")
summary(fe_mod)
fe_mod_time <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country) + factor(year),
data = data,
index = c("mergeid","year"),
model = "within")
pFtest(fe_mod_time, fe_mod)
pFtest(fe_mod, l_mod) # pFtest -> fixed effects better
summary(fe_mod_time)
fe_mod_time <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country) + factor(year),
data = data,
index = c("mergeid","year"),
model = "within")
pFtest(fe_mod_time, fe_mod)
plmtest(fe_mod, c("time"), type=("bp"))
re_mod <- plm(eurod ~ work_horizon + work_horizon_change + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "random")
summary(re_mod)
phtest(fe_mod,re_mod) #Hausman test -> random better
re_mod <- plm(eurod ~ work_horizon + work_horizon_change_bin0 + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "random")
summary(re_mod)
re_mod <- plm(eurod ~ work_horizon + work_horizon_change_bin1 + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "random")
summary(re_mod)
re_mod <- plm(eurod ~ work_horizon + work_horizon_change_bin0 + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "random")
summary(re_mod)
re_mod <- plm(eurod ~ work_horizon + factor(work_horizon_change_cat) + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(industry) + factor(country),
data = data,
index = c("mergeid", "year"),
model = "random")
summary(re_mod)
re_mod <- plm(eurod ~ work_horizon + factor(work_horizon_change_cat) + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(country), #+ factor(industry),
data = data,
index = c("mergeid", "year"),
model = "random")
summary(re_mod)
re_mod <- plm(eurod ~ work_horizon + factor(work_horizon_change_cat) + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(country) + factor(isco), #+ factor(industry),
data = data,
index = c("mergeid", "year"),
model = "random")
summary(re_mod)
re_mod <- plm(eurod ~ work_horizon + factor(work_horizon_change_cat) + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(country), #+ factor(industry),
data = data,
index = c("isco", "year"),
model = "random")
summary(re_mod)
re_mod <- plm(eurod ~ work_horizon + factor(work_horizon_change_cat) + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(country) + factor(industry),
data = data,
index = c("isco", "year"),
model = "random")
summary(re_mod)
re_mod <- plm(eurod ~ work_horizon + factor(work_horizon_change_cat) + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(country) + factor(industry),
data = data,
index = c("mergeid", "year"),
model = "random")
summary(re_mod)
re_mod <- plm(eurod ~ work_horizon + factor(work_horizon_change_cat) + age + I(age_squared) + gender + nb_children + nb_grandchildren + partnerinhh + yrseducation + thinc + thinc_log + investment + life_insurance + sphus + chronic + work_horizon + jqi_skills_discretion + jqi_physical_environment + jqi_social_environment + jqi_working_time_quality + jqi_prospects + jqi_intensity + factor(country) + factor(industry),
data = data,
index = c("isco", "year"),
model = "random")
summary(re_mod)
