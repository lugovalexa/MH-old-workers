did_male_physical_low = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
# DID female/male jqi_social_environment above/below mean
did_female_social_high = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
summary(did_male_physical_high)
summary(did_female)
summary(did_female_intensity_low)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/3digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# children and grandchildren together
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change_total > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change_total > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change_total, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change_total > 0) %>%
distinct(mergeid)
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# Determine cell fol fixed effects/ cluster standard errors
data$cell <- paste(data$country, data$gender, sep = "_")
# Interactions of indexes
interaction_terms <- model.matrix(~ (jqi_skills_discretion + jqi_physical_environment +
jqi_social_environment + jqi_working_time_quality +
jqi_prospects + jqi_intensity)^2, data = data)
interaction_terms <- interaction_terms[, -c(1, 2, 3, 4, 5, 6, 7)]
interaction_terms_colnames <- colnames(interaction_terms)
data <- cbind(data, interaction_terms)
# For YTR between 0 and 1 only
#sum_by_mergeid <- data %>% group_by(mergeid) %>% summarize(total_work_horizon_change = sum(work_horizon_change, na.rm = TRUE))
#mergeid_to_remove <- sum_by_mergeid %>% filter(total_work_horizon_change > 1) %>% pull(mergeid)
#data <- data %>% filter(!(mergeid %in% mergeid_to_remove))
# DID full dataset
did_full <- lm(full_formula, data = data, weights = my_wgt)
# DID full dataset panel fixed effects
did_full_plm = plm(full_formula, data = data, weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male
did_female = lm(full_formula, data = subset(data, gender == 1), weights = my_wgt)
did_male = lm(full_formula, data = subset(data, gender == 0), weights = my_wgt)
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_high = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_low = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_high = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_low = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
# DID female/male jqi_social_environment above/below mean
did_female_social_high = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
summary(did_female_intensity_low)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# children and grandchildren together
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change_total > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change_total > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change_total, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change_total > 0) %>%
distinct(mergeid)
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# Determine cell fol fixed effects/ cluster standard errors
data$cell <- paste(data$country, data$gender, sep = "_")
# Interactions of indexes
interaction_terms <- model.matrix(~ (jqi_skills_discretion + jqi_physical_environment +
jqi_social_environment + jqi_working_time_quality +
jqi_prospects + jqi_intensity)^2, data = data)
interaction_terms <- interaction_terms[, -c(1, 2, 3, 4, 5, 6, 7)]
interaction_terms_colnames <- colnames(interaction_terms)
data <- cbind(data, interaction_terms)
# For YTR between 0 and 1 only
#sum_by_mergeid <- data %>% group_by(mergeid) %>% summarize(total_work_horizon_change = sum(work_horizon_change, na.rm = TRUE))
#mergeid_to_remove <- sum_by_mergeid %>% filter(total_work_horizon_change > 1) %>% pull(mergeid)
#data <- data %>% filter(!(mergeid %in% mergeid_to_remove))
# DID full dataset
did_full <- lm(full_formula, data = data, weights = my_wgt)
# DID full dataset panel fixed effects
did_full_plm = plm(full_formula, data = data, weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male
did_female = lm(full_formula, data = subset(data, gender == 1), weights = my_wgt)
did_male = lm(full_formula, data = subset(data, gender == 0), weights = my_wgt)
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_high = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_low = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_high = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_low = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
# DID female/male jqi_social_environment above/below mean
did_female_social_high = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
summary(did_full_plm)
# DID full dataset
did_full <- lm(full_formula, data = data, weights = my_wgt)
# DID full dataset panel fixed effects
did_full_plm = plm(full_formula, data = data, weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male
did_female = lm(full_formula, data = subset(data, gender == 1), weights = my_wgt)
did_female_plm = plm(full_formula, data = subset(data, gender == 1), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male = lm(full_formula, data = subset(data, gender == 0), weights = my_wgt)
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_high = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_low = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_high = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_low = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
# DID female/male jqi_social_environment above/below mean
did_female_social_high = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
summary(did_female_plm)
# DID full dataset
did_full <- lm(full_formula, data = data, weights = my_wgt)
# DID full dataset panel fixed effects
did_full_plm = plm(full_formula, data = data, weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male
did_female = lm(full_formula, data = subset(data, gender == 1), weights = my_wgt)
did_female_plm = plm(full_formula, data = subset(data, gender == 1), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male = lm(full_formula, data = subset(data, gender == 0), weights = my_wgt)
did_male_plm = plm(full_formula, data = subset(data, gender == 0), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_high = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_low = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_high = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_low = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
# DID female/male jqi_social_environment above/below mean
did_female_social_high = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
summary(did_male_plm)
# DID full dataset
did_full <- lm(full_formula, data = data, weights = my_wgt)
# DID full dataset panel fixed effects
did_full_plm = plm(full_formula, data = data, weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male
did_female = lm(full_formula, data = subset(data, gender == 1), weights = my_wgt)
did_female_plm = plm(full_formula, data = subset(data, gender == 1), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male = lm(full_formula, data = subset(data, gender == 0), weights = my_wgt)
did_male_plm = plm(full_formula, data = subset(data, gender == 0), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low_plm = plm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_skills_high = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_low = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_high = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_low = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
# DID female/male jqi_social_environment above/below mean
did_female_social_high = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
summary(did_female_skills_low_plm)
# DID full dataset
did_full <- lm(full_formula, data = data, weights = my_wgt)
# DID full dataset panel fixed effects
did_full_plm = plm(full_formula, data = data, weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male
did_female = lm(full_formula, data = subset(data, gender == 1), weights = my_wgt)
did_female_plm = plm(full_formula, data = subset(data, gender == 1), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male = lm(full_formula, data = subset(data, gender == 0), weights = my_wgt)
did_male_plm = plm(full_formula, data = subset(data, gender == 0), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_high_plm = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
library(plm)
library(lmtest)
library(dplyr)
library(crosstable)
library(did)
library(car)
library(corrplot)
library(ggplot2)
library(glmnet)
library(MASS)
data <- read.csv("/Users/alexandralugova/Documents/GitHub/MH-old-workers/data/datasets/results/4digits_w46_year_balanced.csv")
# Explanatory variables
# age squared
data$age_squared <- data$age^2
# income log
data$thinc_log <- log(data$thinc + 1)
data$thinc2_log <- log(data$thinc2 + 1)
# children and grandchildren together
# work horizon change binary
data$work_horizon_change_bin0 <- ifelse(data$work_horizon_change_total > 0, 1, 0)
data$work_horizon_change_bin1 <- ifelse(data$work_horizon_change_total > 1, 1, 0)
# work horizon change categorical
data$work_horizon_change_cat <- cut(data$work_horizon_change_total, breaks = c(-Inf, 0, 1, 2, Inf), labels = c("0", "<1", "<2", "2+"), include.lowest = TRUE)
# DID variables
# post treatment period
data$time = ifelse(data$year >= 2015, 1, 0)
# treatment group if work_horizon_change > 0
mergeids_to_treat <- data %>%
filter(time == 1 & work_horizon_change_total > 0) %>%
distinct(mergeid)
data <- data %>%
mutate(treated = ifelse(mergeid %in% mergeids_to_treat$mergeid, 1, 0))
# did
data$did = data$time * data$treated
# Determine cell fol fixed effects/ cluster standard errors
data$cell <- paste(data$country, data$gender, sep = "_")
# Interactions of indexes
interaction_terms <- model.matrix(~ (jqi_skills_discretion + jqi_physical_environment +
jqi_social_environment + jqi_working_time_quality +
jqi_prospects + jqi_intensity)^2, data = data)
interaction_terms <- interaction_terms[, -c(1, 2, 3, 4, 5, 6, 7)]
interaction_terms_colnames <- colnames(interaction_terms)
data <- cbind(data, interaction_terms)
# For YTR between 0 and 1 only
#sum_by_mergeid <- data %>% group_by(mergeid) %>% summarize(total_work_horizon_change = sum(work_horizon_change, na.rm = TRUE))
#mergeid_to_remove <- sum_by_mergeid %>% filter(total_work_horizon_change > 1) %>% pull(mergeid)
#data <- data %>% filter(!(mergeid %in% mergeid_to_remove))
interaction_formula <- paste(interaction_terms_colnames, collapse = " + ")
full_formula <- reformulate(c("time", "treated", "did", "age", "I(age^2)", "nb_children",
"nb_grandchildren", "partnerinhh",  "yrseducation", "thinc2",
"thinc2_log", "investment", "life_insurance", "sphus", "chronic",
"work_horizon", "jqi_skills_discretion",
"jqi_physical_environment", "jqi_social_environment",
"jqi_working_time_quality", "jqi_prospects",
"jqi_intensity", interaction_formula, "factor(cell)",
"factor(industry)"), response = "eurod")
noint_formula <- reformulate(c("treated", "did", "age", "I(age^2)", "nb_children",
"nb_grandchildren", "partnerinhh", "yrseducation", "thinc2",
"thinc2_log", "investment", "life_insurance", "sphus", "chronic",
"work_horizon", "jqi_skills_discretion",
"jqi_physical_environment", "jqi_social_environment",
"jqi_working_time_quality", "jqi_prospects",
"jqi_intensity", "factor(cell)",
"factor(industry)"), response = "eurod")
noind_formula <- reformulate(c("time", "treated", "did", "age", "I(age^2)", "nb_children",
"nb_grandchildren", "partnerinhh", "yrseducation", "thinc2",
"thinc2_log", "investment", "life_insurance", "sphus", "chronic",
"work_horizon", "jqi_sum", "factor(cell)",
"factor(industry)"), response = "eurod")
# DID full dataset
did_full <- lm(full_formula, data = data, weights = my_wgt)
# DID full dataset panel fixed effects
did_full_plm = plm(full_formula, data = data, weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male
did_female = lm(full_formula, data = subset(data, gender == 1), weights = my_wgt)
did_female_plm = plm(full_formula, data = subset(data, gender == 1), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male = lm(full_formula, data = subset(data, gender == 0), weights = my_wgt)
did_male_plm = plm(full_formula, data = subset(data, gender == 0), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_high_plm = plm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_female_skills_low = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low_plm = plm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_skills_high = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_low = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_high = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_low = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
# DID female/male jqi_social_environment above/below mean
did_female_social_high = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
summary(did_full_plm)
summary(did_female_plm)
summary(did_male_plm)
summary(did_female_intensity_low_plm)
summary(did_female_skills_low_plm)
summary(did_female_skills_high_plm)
# DID full dataset
did_full <- lm(full_formula, data = data, weights = my_wgt)
# DID full dataset panel fixed effects
did_full_plm = plm(full_formula, data = data, weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male
did_female = lm(full_formula, data = subset(data, gender == 1), weights = my_wgt)
did_female_plm = plm(full_formula, data = subset(data, gender == 1), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male = lm(full_formula, data = subset(data, gender == 0), weights = my_wgt)
did_male_plm = plm(full_formula, data = subset(data, gender == 0), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_high_plm = plm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_female_skills_low = lm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
did_female_skills_low_plm = plm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_skills_high = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt)
did_male_skills_low = lm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt)
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low = lm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
did_female_physical_low_plm = plm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_physical_high = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt)
did_male_physical_low = lm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt)
# DID female/male jqi_social_environment above/below mean
did_female_social_high = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_female_social_low = lm(full_formula, data = subset(data, gender == 1 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
did_male_social_high = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt)
did_male_social_low = lm(full_formula, data = subset(data, gender == 0 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt)
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_female_time_low = lm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_high = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt)
did_male_time_low = lm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt)
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_female_prospects_low = lm(full_formula, data = subset(data, gender == 1 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_high = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt)
did_male_prospects_low = lm(full_formula, data = subset(data, gender == 0 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt)
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_female_intensity_low = lm(full_formula, data = subset(data, gender == 1 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_high = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt)
did_male_intensity_low = lm(full_formula, data = subset(data, gender == 0 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt)
summary(did_female_physical_low_plm)
crosstable(subset(data, time == 0), c(eurod, eurodcat), by=treated, test=TRUE) %>%
as_flextable(fontsizes = list(body = 8, subheaders = 8, header = 8),)
# DID full dataset
did_full <- lm(full_formula, data = data, weights = my_wgt)
# DID full dataset panel fixed effects
did_full_plm = plm(full_formula, data = data, weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male
did_female = plm(full_formula, data = subset(data, gender == 1), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male = plm(full_formula, data = subset(data, gender == 0), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_skills_discretion above/below mean
did_female_skills_high = plm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_female_skills_low= plm(full_formula, data = subset(data, gender == 1 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_skills_high = plm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion >= mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_skills_low = plm(full_formula, data = subset(data, gender == 0 & jqi_skills_discretion < mean(jqi_skills_discretion)), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_physical_environment above/below mean
did_female_physical_high = plm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_female_physical_low = plm(full_formula, data = subset(data, gender == 1 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_physical_high = plm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment >= mean(jqi_physical_environment)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_physical_low = plm(full_formula, data = subset(data, gender == 0 & jqi_physical_environment < mean(jqi_physical_environment)), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_social_environment above/below mean
did_female_social_high = plm(full_formula, data = subset(data, gender == 1 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_female_social_low = plm(full_formula, data = subset(data, gender == 1 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_social_high = plm(full_formula, data = subset(data, gender == 0 & jqi_social_environment >= mean(jqi_social_environment)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_social_low = plm(full_formula, data = subset(data, gender == 0 & jqi_social_environment < mean(jqi_social_environment)), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_working_time_quality above/below mean
did_female_time_high = plm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_female_time_low = plm(full_formula, data = subset(data, gender == 1 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_time_high = plm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality >= mean(jqi_working_time_quality)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_time_low = plm(full_formula, data = subset(data, gender == 0 & jqi_working_time_quality < mean(jqi_working_time_quality)), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_prospects above/below mean
did_female_prospects_high = plm(full_formula, data = subset(data, gender == 1 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_female_prospects_low = plm(full_formula, data = subset(data, gender == 1 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_prospects_high = plm(full_formula, data = subset(data, gender == 0 & jqi_prospects >= mean(jqi_prospects)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_prospects_low = plm(full_formula, data = subset(data, gender == 0 & jqi_prospects < mean(jqi_prospects)), weights = my_wgt, index = c("mergeid","year"), model = "within")
# DID female/male jqi_intensity above/below mean
did_female_intensity_high = plm(full_formula, data = subset(data, gender == 1 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_female_intensity_low = plm(full_formula, data = subset(data, gender == 1 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_intensity_high = plm(full_formula, data = subset(data, gender == 0 & jqi_intensity >= mean(jqi_intensity)), weights = my_wgt, index = c("mergeid","year"), model = "within")
did_male_intensity_low = plm(full_formula, data = subset(data, gender == 0 & jqi_intensity < mean(jqi_intensity)), weights = my_wgt, index = c("mergeid","year"), model = "within")
summary(did_full_plm)
summary(did_female_plm)
summary(did_male_plm)
summary(did_female)
summary(did_female_intensity_low)
summary(did_female_intensity_high)
summary(did_female_prospects_low)
summary(did_female_intensity_low)
